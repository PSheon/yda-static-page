(this["webpackJsonpys-main-web"]=this["webpackJsonpys-main-web"]||[]).push([[17],{1e3:function(e,t,a){"use strict";a.r(t);var n=a(9),r=a(26),o=a(0),i=a.n(o),l=a(872),s=a(142),c=a(856),u=a(876),d=a(879),m=a(869),p=a(865),f=a(866),h=a(95),b=a(315),g=a(410),v=a(76),y=a(143),w=a(8),x=a(30),E=a(888),O=a.n(E),j=a(3),N=a(15),C=a(6),k=a(980),S=a.n(k),T=a(11),I=a(917),M=a(46),_=a(13),P=a(60),R=a(293);a(922),a(923),a(924),a(925),a(926);function z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function F(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?z(a,!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):z(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var L=Object(w.a)({root:{"& label.Mui-focused":{color:"#3e3e3e"},"& .MuiInput-underline:after":{borderBottomColor:"#fefefe"},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#5e5e5e"},"&:hover fieldset":{borderColor:"#3e3e3e"},"&.Mui-focused fieldset":{borderColor:"#3e3e3e"}},"& .MuiOutlinedInput-notchedOutline":{borderRadius:"2.4rem"}}})(l.a),A=Object(g.a)((function(e){return{newsImageFeaturedStar:{position:"absolute",top:0,right:0,color:b.a[400],opacity:0},newsImageUpload:{transitionProperty:"box-shadow",transitionDuration:e.transitions.duration.short,transitionTimingFunction:e.transitions.easing.easeInOut},newsImageItem:{transitionProperty:"box-shadow",transitionDuration:e.transitions.duration.short,transitionTimingFunction:e.transitions.easing.easeInOut,"&:hover":{"& $newsImageFeaturedStar":{opacity:.8}},"&.featured":{pointerEvents:"none",boxShadow:e.shadows[3],"& $newsImageFeaturedStar":{opacity:1},"&:hover $newsImageFeaturedStar":{opacity:1}}}}}));t.default=function(e){var t=Object(C.b)(),a=e.match.params.newsId,n=Object(C.c)((function(e){return e.homePage.news})),l=Object(C.c)((function(e){return e.uploads.image})),b=l.docs,g=A(e),w=Object(o.useState)(0),E=Object(r.a)(w,2),k=E[0],z=E[1],B=Object(o.useState)(!0),H=Object(r.a)(B,2),W=H[0],U=H[1],D=Object(o.useState)(!1),V=Object(r.a)(D,2),q=V[0],J=V[1],G=Object(o.useState)(!1),$=Object(r.a)(G,2),X=$[0],K=$[1],Q=Object(y.c)(null),Y=Q.form,Z=Q.handleChange,ee=Q.setForm;function te(){U(!0),t(_.B(Y))}function ae(){return Y.title&&Y.subTitle&&Y.content&&Y.imageName}return Object(o.useEffect)((function(){t(_.W())}),[t]),Object(o.useEffect)((function(){if(!Y)if("new"===a)ee({_id:"new",title:"",subTitle:"",imageName:"",content:"",tags:[],published:!1}),U(!1);else if(n.docs.length){var e=n.docs.filter((function(e){return e._id===a}))[0];e?(ee(e),U(!1)):h.a.push({pathname:"/staff/news-list"})}else t(_.V(a))}),[n.docs,t,Y,a,ee]),i.a.createElement(v.m,{classes:{toolbar:"p-0",header:"min-h-128 h-128 sm:h-136 sm:min-h-136"},header:Y&&i.a.createElement("div",{className:"flex flex-1 w-full items-center justify-between"},i.a.createElement("div",{className:"flex flex-col items-start"},i.a.createElement(v.a,{animation:"transition.slideRightIn",delay:300},i.a.createElement(s.a,{className:"normal-case flex items-center mb-12",component:x.a,role:"button",to:"/staff/news-list",color:"inherit"},i.a.createElement(c.a,{className:"mr-4 text-20"},"arrow_back"),"\u8fd4\u56de \u65b0\u805e\u5217\u8868")),i.a.createElement("div",{className:"flex items-center max-w-200 sm:max-w-512"},i.a.createElement(v.a,{animation:"transition.expandIn",delay:300},Y.imageName?i.a.createElement("img",{className:"w-32 sm:w-48 mr-8 sm:mr-16 rounded",src:Object(M.f)(Y.imageName),alt:Y.title}):i.a.createElement("img",{className:"w-32 sm:w-48 mr-8 sm:mr-16 rounded",src:"assets/images/ecommerce/product-image-placeholder.png",alt:"\u9810\u8a2d\u5716\u7247"})),i.a.createElement("div",{className:"flex flex-col min-w-0"},i.a.createElement(v.a,{animation:"transition.slideLeftIn",delay:300},i.a.createElement(s.a,{className:"text-16 sm:text-20 truncate"},Y.title?Y.title:"\u65b0\u589e \u65b0\u805e")),i.a.createElement(v.a,{animation:"transition.slideLeftIn",delay:300},i.a.createElement(s.a,{variant:"caption"},"\u65b0\u805e\u5167\u5bb9"))))),"new"===a?i.a.createElement(v.a,{animation:"transition.slideRightIn",delay:300},i.a.createElement(u.a,{className:"whitespace-no-wrap mx-12 rounded-full",variant:"contained",color:"secondary",disabled:!ae(),onClick:te},W?i.a.createElement("span",{className:"flex justify-center"},"\u65b0\u589e\u65b0\u805e\u4e2d ",i.a.createElement(R.a,{width:"2em",height:"2em"})):"\u65b0\u589e\u65b0\u805e")):i.a.createElement("div",{className:"flex flex-row justify-around items-center h-full"},i.a.createElement(v.a,{animation:"transition.slideRightIn",delay:300},i.a.createElement(u.a,{className:"whitespace-no-wrap px-12 rounded-full bg-red text-white hover:bg-red-300",variant:"contained",onClick:function(){J(!0),t(_.o(a))},disabled:n.docs.length<2},q?i.a.createElement("span",{className:"flex justify-center"},"\u522a\u9664\u65b0\u805e\u4e2d ",i.a.createElement(R.a,{width:"2em",height:"2em"})):"\u522a\u9664\u65b0\u805e")),i.a.createElement(v.a,{animation:"transition.slideRightIn",delay:300},i.a.createElement(u.a,{className:"whitespace-no-wrap mx-12 rounded-full",variant:"contained",color:"secondary",disabled:!ae(),onClick:te},W?i.a.createElement("span",{className:"flex justify-center"},"\u66f4\u65b0\u65b0\u805e\u4e2d ",i.a.createElement(R.a,{width:"2em",height:"2em"})):"\u66f4\u65b0\u65b0\u805e")))),contentToolbar:i.a.createElement(d.a,{value:k,onChange:function(e,t){z(t)},indicatorColor:"secondary",textColor:"secondary",variant:"scrollable",scrollButtons:"auto",classes:{root:"w-full h-64"}},i.a.createElement(m.a,{className:"h-64 normal-case",label:"\u65b0\u805e\u8a2d\u5b9a"}),i.a.createElement(m.a,{className:"h-64 normal-case",label:"\u5167\u5bb9\u8a2d\u5b9a"}),i.a.createElement(m.a,{className:"h-64 normal-case",label:"\u5c01\u9762\u8a2d\u5b9a"})),content:Y&&i.a.createElement("div",{className:"p-16 sm:p-24 max-w-2xl max-h-screen"},0===k&&i.a.createElement("div",null,i.a.createElement(L,{className:"mt-8 mb-16",error:""===Y.title,required:!0,label:"\u5927\u6a19\u984c",autoFocus:!0,id:"title",name:"title",value:Y.title,onChange:Z,type:"text",variant:"outlined",fullWidth:!0}),i.a.createElement(L,{className:"mt-8 mb-16",error:""===Y.subTitle,required:!0,label:"\u526f\u6a19\u984c",id:"subTitle",name:"subTitle",value:Y.subTitle,onChange:Z,type:"text",variant:"outlined",fullWidth:!0}),i.a.createElement(v.d,{className:"mt-8 mb-16",value:Y.tags.map((function(e){return{value:e,label:e}})),onChange:function(e){return function(e,t){ee(N.a.set(F({},Y),t,e.map((function(e){return e.value}))))}(e,"tags")},placeholder:"\u52a0\u500b\u65b0\u805e\u6a19\u7c64\u5427",textFieldProps:{label:"\u65b0\u805e\u6a19\u7c64",InputLabelProps:{shrink:!0},variant:"outlined"},isMulti:!0}),i.a.createElement(p.a,{className:"mt-8 mb-16",label:"\u767c\u4f48\u65b0\u805e",labelPlacement:"start",control:i.a.createElement(f.a,{checked:Y.published,id:"published",name:"published",onChange:Z})})),1===k&&Y&&i.a.createElement(v.a,{animation:"transition.slideRightIn",delay:300},i.a.createElement("div",{className:"mx-36 pb-128"},i.a.createElement(S.a,{tag:"div",model:Y.content,config:{placeholderText:"\u5beb\u9ede\u65b0\u805e\u5427\uff01",language:"zh_tw",heightMin:350,heightMax:550,toolbarInline:!0,toolbarVisibleWithoutSelection:!0,dragInline:!1,pluginsEnabled:["align","codeBeautifier","codeView","colors","draggable","embedly","emoticons","entities","fontAwesome","fontSize","image","imageManager","lineBreaker","lineHeight","link","lists","paragraphFormat","paragraphStyle","quote","save","url","video","wordPaste"],imageInsertButtons:["imageBack","|","imageByURL","imageManager"],videoInsertButtons:["videoBack","|","videoByURL","videoEmbed"],linkInsertButtons:["linkBack"],requestHeaders:{Authorization:"Bearer "+window.localStorage.getItem("jwt_access_token")},imageManagerLoadParams:{page:1,limit:20,sort:"updatedAt",order:-1},imageManagerPageSize:20,imageManagerLoadURL:"".concat(T.a,"/api/image/manager"),videoResponsive:!0,charCounterCount:!1,tabSpaces:4,imageUpload:!1},onModelChange:function(e){ee((function(t){return N.a.setIn(F({},t),"content",e)}))}}))),2===k&&i.a.createElement(v.a,{animation:"transition.slideRightIn",delay:300},i.a.createElement("div",{className:"flex justify-center sm:justify-start flex-wrap"},i.a.createElement(I.a,{trigger:i.a.createElement("label",{htmlFor:"button-file",className:Object(j.a)(g.newsImageUpload,"flex items-center justify-center relative w-128 h-128 rounded-4 mr-16 mb-16 overflow-hidden cursor-pointer shadow-1 hover:shadow-5")},i.a.createElement(c.a,{fontSize:"large",color:"action"},"cloud_upload"))}),b.map((function(e,t){return i.a.createElement("div",{onClick:function(){return t=e.imageName,void ee((function(e){return N.a.setIn(F({},e),"imageName",t)}));var t},className:Object(j.a)(g.newsImageItem,"flex items-center justify-center relative h-128 rounded-4 mr-16 mb-16 overflow-hidden cursor-pointer shadow-1 hover:shadow-5",e.imageName===Y.imageName&&"featured"),key:t},i.a.createElement(c.a,{className:g.newsImageFeaturedStar},"star"),i.a.createElement("img",{className:"max-w-none w-auto h-full",src:Object(M.f)(e.imageName),alt:"\u5716\u7247"}))})),i.a.createElement(O.a,null,(function(e){var a=e.isVisible;return i.a.createElement("div",{className:"flex justify-center items-center w-full min-h-10"},X&&i.a.createElement(R.a,{width:128,height:128}),a&&!X&&function(){if(l.hasNextPage){K(!0);var e={page:l.nextPage,limit:20,sort:"updatedAt",order:-1};P.a.getUploadedImages(e).then((function(e){t({type:_.c,payload:e}),K(!1)}))}}())})))))})}},917:function(e,t,a){"use strict";var n=a(906),r=a.n(n),o=a(907),i=a(26),l=a(0),s=a.n(l),c=a(6),u=a(8),d=a(878),m=a(76),p=a(3),f=a(874),h=a(142),b=a(872),g=a(931),v=a(964),y=a(815),w=a(894),x=a.n(w),E=a(808),O=a(908),j=a(11),N=a(13),C=a(909),k=a.n(C),S=a(910),T=a.n(S),I=a(911),M=a.n(I),_=a(912),P=a.n(_),R=a(913),z=a.n(R),F=a(914),L=a.n(F);a(915),a(916);Object(O.registerPlugin)(k.a,z.a,T.a,M.a,P.a,L.a);var A=Object(u.a)({root:{"& label.Mui-focused":{color:"#000000"},"& .MuiInput-underline:after":{borderBottomColor:"#2e2e2e"},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#2e2e2e"},"&:hover fieldset":{borderColor:"#000000"},"&.Mui-focused fieldset":{borderColor:"#000000"}},"& .MuiOutlinedInput-notchedOutline":{borderRadius:"2.4rem"}}})(b.a),B=Object(d.a)((function(e){return{tag:{transition:"background-color .3s, transform .3s"},red:{backgroundColor:"transparent",border:"2.5px solid #ef7c71","&.active, &:hover":{backgroundColor:"#ef7c71",transform:"scale(1.3)",boxShadow:"0 15px 30px 0 rgba(0,0,0,0.11), 0 5px 15px 0 rgba(0,0,0,0.08)"}},orange:{backgroundColor:"transparent",border:"2.5px solid #f5bb67","&.active, &:hover":{backgroundColor:"#f5bb67",transform:"scale(1.3)",boxShadow:"0 15px 30px 0 rgba(0,0,0,0.11), 0 5px 15px 0 rgba(0,0,0,0.08)"}},yellow:{backgroundColor:"transparent",border:"2.5px solid #fbe571","&.active, &:hover":{backgroundColor:"#fbe571",transform:"scale(1.3)",boxShadow:"0 15px 30px 0 rgba(0,0,0,0.11), 0 5px 15px 0 rgba(0,0,0,0.08)"}},green:{backgroundColor:"transparent",border:"2.5px solid #80db7b","&.active, &:hover":{backgroundColor:"#80db7b",transform:"scale(1.3)",boxShadow:"0 15px 30px 0 rgba(0,0,0,0.11), 0 5px 15px 0 rgba(0,0,0,0.08)"}},blue:{backgroundColor:"transparent",border:"2.5px solid #63a5f8","&.active, &:hover":{backgroundColor:"#63a5f8",transform:"scale(1.3)",boxShadow:"0 15px 30px 0 rgba(0,0,0,0.11), 0 5px 15px 0 rgba(0,0,0,0.08)"}},purple:{backgroundColor:"transparent",border:"2.5px solid #cb8cf8","&.active, &:hover":{backgroundColor:"#cb8cf8",transform:"scale(1.3)",boxShadow:"0 15px 30px 0 rgba(0,0,0,0.11), 0 5px 15px 0 rgba(0,0,0,0.08)"}},gray:{backgroundColor:"transparent",border:"2.5px solid #b4b4b8","&.active, &:hover":{backgroundColor:"#b4b4b8",transform:"scale(1.3)",boxShadow:"0 15px 30px 0 rgba(0,0,0,0.11), 0 5px 15px 0 rgba(0,0,0,0.08)"}},closeButton:{position:"absolute",right:5,top:"5px"},filePondWrapper:{opacity:".6",transition:"opacity .3s","& .filepond--root":{borderBottom:"none","& .filepond--drop-label":{color:"#2e2e2e",fontSize:"2em",fontWeight:"600"},"& .filepond--file-status":{fontSize:"2em"},"& .filepond--file-action-button":{fontSize:"2em"},"& .filepond--file-info-main":{fontSize:"2em"},"& .filepond--file-info-sub":{fontSize:"1.5em"}},"& .filepond--panel-root":{fontSize:"1.75em",backgroundColor:"transparent"},"&:hover, &.active":{opacity:"1",cursor:"pointer"}}}})),H=s.a.forwardRef((function(e,t){return s.a.createElement(y.a,Object.assign({direction:"up",ref:t},e))}));t.a=function(e){var t=B(e),a=Object(c.b)(),n=Object(c.c)((function(e){return e.auth.user.data.displayName})),u=Object(l.useState)(!1),d=Object(i.a)(u,2),b=d[0],y=d[1],w=Object(l.useState)(null),C=Object(i.a)(w,2),k=C[0],S=C[1],T=Object(l.useState)([]),I=Object(i.a)(T,2),M=I[0],_=I[1];function P(){S(null),y(!1)}function R(e){var t=new Set(M);t.has(e)?t.delete(e):t.add(e),_(Array.from(t))}return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{onClick:function(){y(!0)}},e.trigger),s.a.createElement(f.a,{classes:{paper:"rounded-12"},fullWidth:!0,fullScreen:!1,open:b,onClose:P,TransitionComponent:H},s.a.createElement(v.a,{disableTypography:!0,className:"text-center text-20 sm:text-24 font-semibold"},"\u4e0a\u50b3\u6211\u7684\u5716\u7247",s.a.createElement(E.a,{"aria-label":"Close",className:t.closeButton,onClick:P},s.a.createElement(x.a,null))),s.a.createElement(g.a,{className:"-mt-10"},s.a.createElement(m.a,null,s.a.createElement(h.a,{className:"mt-22 sm:mt-22 sm:py-12 text-14 sm:text-20 font-600 text-center pb-10",color:"inherit"},"\u76ee\u524d\u50c5\u652f\u63f4\u985e\u578b",s.a.createElement("br",null),s.a.createElement("span",{className:"text-blue"},"JPG\u3001PNG")," \u548c",s.a.createElement("span",{className:"text-blue"},"SVG")," \u7684\u5716\u7247")),null!==k&&s.a.createElement(m.b,{enter:{animation:"transition.expandIn"}},s.a.createElement(A,{className:"mb-24",label:"\u5716\u7247\u8aaa\u660e",id:"imageCaption",name:"imageCaption",value:k,onChange:function(e){return S(e.target.value)},variant:"outlined",fullWidth:!0}),s.a.createElement("div",{className:"flex justify-around items-center mb-24"},s.a.createElement("div",{onClick:function(){return R("red")},className:Object(p.a)(t.tag,t.red,M.includes("red")&&"active","cursor-pointer w-24 h-24 rounded-full hover:shadow-xl")}),s.a.createElement("div",{onClick:function(){return R("orange")},className:Object(p.a)(t.tag,t.orange,M.includes("orange")&&"active","cursor-pointer w-24 h-24 rounded-full hover:shadow-xl")}),s.a.createElement("div",{onClick:function(){return R("yellow")},className:Object(p.a)(t.tag,t.yellow,M.includes("yellow")&&"active","cursor-pointer w-24 h-24 rounded-full hover:shadow-xl")}),s.a.createElement("div",{onClick:function(){return R("green")},className:Object(p.a)(t.tag,t.green,M.includes("green")&&"active","cursor-pointer w-24 h-24 rounded-full hover:shadow-xl")}),s.a.createElement("div",{onClick:function(){return R("blue")},className:Object(p.a)(t.tag,t.blue,M.includes("blue")&&"active","cursor-pointer w-24 h-24 rounded-full hover:shadow-xl")}),s.a.createElement("div",{onClick:function(){return R("purple")},className:Object(p.a)(t.tag,t.purple,M.includes("purple")&&"active","cursor-pointer w-24 h-24 rounded-full hover:shadow-xl")}),s.a.createElement("div",{onClick:function(){return R("gray")},className:Object(p.a)(t.tag,t.gray,M.includes("gray")&&"active","cursor-pointer w-24 h-24 rounded-full hover:shadow-xl")}))),s.a.createElement("div",{className:Object(p.a)(t.filePondWrapper,"mb-12 rounded-12 border-3 border-dotted")},s.a.createElement(O.FilePond,{labelIdle:"\u9ede\u64ca \u6216 \u62d6\u66f3\u4f86 <span class='filepond--label-action'>\u4e0a\u50b3\u5716\u7247 </span>",labelInvalidField:"\u8acb\u4e0a\u50b3\u5716\u7247",labelFileWaitingForSize:"\u6aa2\u67e5\u5716\u7247\u5927\u5c0f",labelFileSizeNotAvailable:"\u5716\u7247\u6a94\u6848\u592a\u5927\u4e86",labelFileLoading:"\u8f09\u5165\u4e2d",labelFileLoadError:"\u51fa\u932f\u4e86",labelFileProcessing:"\u4e0a\u50b3\u4e2d",labelFileProcessingComplete:"\u4e0a\u50b3\u5b8c\u6210",labelFileProcessingAborted:"\u4e0a\u50b3\u5df2\u53d6\u6d88",labelTapToCancel:"\u53d6\u6d88",labelTapToRetry:"\u91cd\u65b0\u4e0a\u50b3",labelButtonRemoveItem:"\u79fb\u9664\u5716\u7247",labelButtonProcessItem:"\u4e0a\u50b3",allowMultiple:!1,labelFileTypeNotAllowed:"\u4e0d\u652f\u63f4\u7684\u5716\u7247\u683c\u5f0f",acceptedFileTypes:["image/jpeg","image/png","image/svg+xml"],dropValidation:!0,maxFileSize:"12MB",imageCropAspectRatio:"1:1",instantUpload:!1,fileValidateTypeLabelExpectedTypesMap:{"image/jpeg":".jpg","image/png":".png","image/svg+xml":".svg"},onupdatefiles:function(){var e=Object(o.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.length){e.next=3;break}return e.next=3,S("".concat(n,"_").concat(t[0].file.name));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),server:{url:"".concat(j.a,"/api/image"),timeout:7e3,process:function(e,t,n,r,o,i,l){var s=new FormData;s.append("imageData",t,t.name),s.append("imageName",t.name),s.append("imageTags",M),s.append("imageCaption",k),s.append("mimeType",t.type),s.append("imageHeight",n.size.height),s.append("imageWidth",n.size.width),s.append("imageSize",t.size);var c=new XMLHttpRequest;return c.open("POST","".concat(j.a,"/api/image")),c.setRequestHeader("Authorization","Bearer "+window.localStorage.getItem("jwt_access_token")),c.upload.onprogress=function(e){i(e.lengthComputable,e.loaded,e.total)},c.onload=function(){c.status>=200&&c.status<300?(r(c.responseText),a({type:N.a,payload:JSON.parse(c.responseText)}),a({type:N.e,options:{message:"\u5716\u7247\u4ef6\u4e0a\u50b3\u6210\u529f"}}),y(!1)):o("oh no")},c.send(s),{abort:function(){c.abort(),l()}}}}})),s.a.createElement(m.a,null,s.a.createElement(h.a,{className:"mt-22 sm:mt-22 sm:py-12 text-14 sm:text-20 font-600 text-center pb-10",color:"inherit"},"\u5927\u5c0f\u9650\u5236 ",s.a.createElement("span",{className:"text-blue"},"12 MB"))))))}},980:function(e,t,a){var n,r;window,e.exports=(n=a(0),r=a(905),function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=3)}([function(e,t){e.exports=n},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=i(a(2)),o=i(a(0));function i(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.tag=null,a.defaultTag="div",a.listeningEvents=[],a.element=null,a.editor=null,a.config={immediateReactModelUpdate:!1,reactIgnoreAttrs:null},a.editorInitialized=!1,a.SPECIAL_TAGS=["img","button","input","a"],a.INNER_HTML_ATTR="innerHTML",a.hasSpecialTag=!1,a.oldModel=null,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Component),n(t,[{key:"componentWillMount",value:function(){this.tag=this.props.tag||this.defaultTag}},{key:"componentDidMount",value:function(){var e=this.el.tagName.toLowerCase();-1!=this.SPECIAL_TAGS.indexOf(e)&&(this.tag=e,this.hasSpecialTag=!0),this.props.onManualControllerReady?this.generateManualController():this.createEditor()}},{key:"componentWillUnmount",value:function(){this.destroyEditor()}},{key:"componentDidUpdate",value:function(){JSON.stringify(this.oldModel)!=JSON.stringify(this.props.model)&&this.setContent()}},{key:"createEditor",value:function(){var e=this;if(!this.editorInitialized&&(this.config=this.props.config||this.config,this.element=this.el,this.props.model&&(this.element.innerHTML=this.props.model),this.setContent(!0),this.registerEvent("initialized",this.config.events&&this.config.events.initialized),this.config.events||(this.config.events={}),this.config.events.initialized=function(){return e.initListeners()},this.editor=new r.default(this.element,this.config),this._initEvents))for(var t=0;t<this._initEvents.length;t++)this._initEvents[t].call(this.editor)}},{key:"setContent",value:function(e){(this.props.model||""==this.props.model)&&(this.oldModel=this.props.model,this.hasSpecialTag?this.setSpecialTagContent():this.setNormalTagContent(e))}},{key:"setNormalTagContent",value:function(e){var t=this,a=this;function n(){a.editor.html&&a.editor.html.set(a.props.model||""),a.editorInitialized&&a.editor.undo&&(a.editor.undo.reset(),a.editor.undo.saveStep())}e?this.config.initOnClick?(this.registerEvent("initializationDelayed",(function(){n()})),this.registerEvent("initialized",(function(){t.editorInitialized=!0}))):this.registerEvent("initialized",(function(){t.editorInitialized=!0,n()})):n()}},{key:"setSpecialTagContent",value:function(){var e=this.props.model;if(e){for(var t in e)e.hasOwnProperty(t)&&t!=this.INNER_HTML_ATTR&&this.element.setAttribute(t,e[t]);e.hasOwnProperty(this.INNER_HTML_ATTR)&&(this.element.innerHTML=e[this.INNER_HTML_ATTR])}}},{key:"destroyEditor",value:function(){this.element&&(this.editor.destroy&&this.editor.destroy(),this.listeningEvents.length=0,this.element=null,this.editorInitialized=!1)}},{key:"getEditor",value:function(){return this.element?this.editor:null}},{key:"generateManualController",value:function(){var e=this,t={initialize:function(){return e.createEditor.call(e)},destroy:function(){return e.destroyEditor.call(e)},getEditor:function(){return e.getEditor.call(e)}};this.props.onManualControllerReady(t)}},{key:"updateModel",value:function(){if(this.props.onModelChange){var e="";if(this.hasSpecialTag){for(var t=this.element.attributes,a={},n=0;n<t.length;n++){var r=t[n].name;this.config.reactIgnoreAttrs&&-1!=this.config.reactIgnoreAttrs.indexOf(r)||(a[r]=t[n].value)}this.element.innerHTML&&(a[this.INNER_HTML_ATTR]=this.element.innerHTML),e=a}else{var o=this.editor.html.get();"string"==typeof o&&(e=o)}this.oldModel=e,this.props.onModelChange(e)}}},{key:"initListeners",value:function(){var e=this;this.editor.events.on("contentChanged",(function(){e.updateModel()})),this.config.immediateReactModelUpdate&&this.editor.events.on("keyup",(function(){e.updateModel()}))}},{key:"registerEvent",value:function(e,t){e&&t&&("initialized"==e?(this._initEvents||(this._initEvents=[]),this._initEvents.push(t)):(this.config.events||(this.config.events={}),this.config.events[e]=t))}}]),t}();t.default=l},function(e,t){e.exports=r},function(e,t,a){e.exports=a(4)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=i(a(1)),o=i(a(0));function i(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),n(t,[{key:"render",value:function(){var e=this;return o.default.createElement(this.tag,{ref:function(t){return e.el=t}},this.props.children)}}]),t}();t.default=l}]))}}]);